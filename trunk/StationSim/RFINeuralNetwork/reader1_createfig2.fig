global freq;
global HBtnColorBar;
global HMainFig ;
global HDspFig ;
global HTimeFig ;
global HThreeDFig ;
global HSpecgramFig ;

%==================================
%define general aspects

FrameWidth = 0.12; 

LeftBorder = 0.05; BottomBorder=0.05; 
TotalWidth = 1 - 3*LeftBorder-FrameWidth ; TotalHeight = 1-2*BottomBorder;
FigSpace = 0.05;
Col1Width = 0.3*TotalWidth;
Col2Width = TotalWidth-Col1Width-FigSpace;
Lin1Height = 0.3*TotalHeight;
Lin2Height= TotalHeight-Lin1Height-FigSpace;

FrameBorder = 0.01;
LeftFrameBorder = LeftBorder + Col1Width+Col2Width+2*FigSpace;
FrameHeight = TotalHeight;
CompBackGroundColor = [0.5 0.5 0.5];



%create figure 1 and set its attributs
MainFigPos = [ 5 35 1017 663];
shh = get(0,'ShowHiddenHandles');
set(0,'ShowHiddenHandles','on')
%Figure principale
HMainFig = figure(...
   'Name','Spectrogramme', ...
   'handlevisibility','callback',...
   'IntegerHandle','off',...
   'NumberTitle','off',...
   'Tag','MainFig',...
   'position',MainFigPos);
     
 %==================================
 % Set up main axes of MainFig
 axes( ...
    'Units','normalized', ...
    'Position',[LeftBorder BottomBorder TotalWidth TotalHeight]);
 
 set(HMainFig,'defaultaxesposition',[LeftBorder BottomBorder TotalWidth TotalHeight])
 
 %==================================
 % Define 3D subplot properties
 %HThreeDFig = subplot(2,2,1);
 %set(gca, ...
 %   'Units','normalized', ...
 %   'Position',[LeftBorder BottomBorder+Lin2Height+FigSpace Col1Width Lin1Height], ...
 %   'XTick',[],'YTick',[], ...
 %   'Box','on');
 %==================================
 % Define time plot
 HTimeFig = subplot(2,2,2);
 set(gca, ...
    'Units','normalized', ...
    'Position',[LeftBorder+Col1Width+FigSpace BottomBorder+Lin2Height+FigSpace Col2Width Lin1Height], ...
    'XTick',[],'YTick',[], ...
    'Box','on');
%==================================
 % Define dsp plot
 HDspFig = subplot(2,2,3);
 set(gca, ...
    'Units','normalized', ...
    'Position',[LeftBorder BottomBorder Col1Width Lin2Height], ...
    'XTick',[],'YTick',[], ...
    'Box','on');
%==================================
 % Define specgram plot
 HSpecgramFig = subplot(2,2,4);
 set(gca, ...
    'Units','normalized', ...
    'Position',[LeftBorder+Col1Width+FigSpace  BottomBorder Col2Width Lin2Height], ...
    'XTick',[],'YTick',[], ...
    'Box','on');
 
 %====================================
 % Information for all buttons (and menus)
 CompHeight = 0.03;

 % Spacing between the button and the next command's label
 CompSpace = 0.02;
 
%====================================
% The CONSOLE frame

frmPos=[LeftFrameBorder BottomBorder FrameWidth FrameHeight ];
h=uicontrol( ...
   'Style','frame', ...
   'Units','normalized', ...
   'Position',frmPos, ...
   'BackgroundColor',CompBackGroundColor );

% First Frame Component attributs

CompLeft = LeftFrameBorder + FrameBorder;
CompBottom = FrameHeight - FrameBorder - CompHeight;
CompWidth = FrameWidth - 2*FrameBorder;

% Affichage label 
CompPos = [CompLeft CompBottom CompWidth CompHeight];
h = uicontrol( ...
   'Style','text', ...
   'Units','normalized', ...
   'Position',CompPos, ...
   'Horiz','left', ...
   'String','Affichage :', ...
   'Interruptible','off', ...
   'BackgroundColor',CompBackGroundColor , ...
   'ForegroundColor','white');

% Map Menu label 
CompBottom = CompBottom - CompHeight - CompSpace;
CompWidth = 0.4*FrameWidth - FrameBorder;
CompPos = [CompLeft CompBottom CompWidth CompHeight];
h = uicontrol( ...
   'Style','text', ...
   'Units','normalized', ...
   'Position',CompPos, ...
   'Horiz','left', ...
   'String','Coul. :', ...
   'Interruptible','off', ...
   'BackgroundColor',CompBackGroundColor , ...
   'ForegroundColor','white');


% Map Menu
CompWidth = 0.6*FrameWidth - FrameBorder;

CompPos = [CompLeft+0.4*FrameWidth-FrameBorder CompBottom CompWidth CompHeight];
CompStr='Default|Bone|Jet|Hsv|Hot|Cool|Gray';
callbackStr='reader1_setmapcolor';
HColorMap=uicontrol( ...
   'Style','popup', ...
   'Units','normalized', ...
   'Position',CompPos, ...
   'String',CompStr, ...
   'Callback',callbackStr);

% Brigthness label 
CompBottom = CompBottom - CompHeight - CompSpace;
CompWidth = 0.4*FrameWidth - FrameBorder;
CompPos = [CompLeft CompBottom CompWidth CompHeight];
h = uicontrol( ...
   'Style','text', ...
   'Units','normalized', ...
   'Position',CompPos, ...
   'Horiz','left', ...
   'String','Dyn. :', ...
   'Interruptible','off', ...
   'BackgroundColor',CompBackGroundColor , ...
   'ForegroundColor','white');

% Brigthness Btn1
CompWidth = 0.3*FrameWidth - FrameBorder;
CompPos = [CompLeft+0.4*FrameWidth-FrameBorder CompBottom CompWidth CompHeight];
CompStr='+';
callbackStr='reader1_setbrightnessup';
HBtnPlus=uicontrol( ...
   'Style','pushbutton', ...
   'Units','normalized', ...
   'Position',CompPos, ...
   'String',CompStr, ...
   'Callback',callbackStr);

% Brigthness Btn2
CompWidth = 0.3*FrameWidth - FrameBorder;
CompPos = [CompLeft+0.7*FrameWidth-FrameBorder CompBottom CompWidth CompHeight];
CompStr='-';
callbackStr='reader1_setbrightnessdown';
HBtnMoins=uicontrol( ...
   'Style','pushbutton', ...
   'Units','normalized', ...
   'Position',CompPos, ...
   'String',CompStr, ...
   'Callback',callbackStr);


% Colorbar btn
CompBottom = CompBottom - CompHeight - CompSpace;
CompWidth = FrameWidth - 2*FrameBorder;
CompPos = [CompLeft CompBottom CompWidth CompHeight];
BtnState = 0;
CompStr='Voir Echelle';
callbackStr='reader1_scale';
HBtnColorBar=uicontrol( ...
   'Style','pushbutton', ...
   'Units','normalized', ...
   'Position',CompPos, ...
   'String',CompStr, ...
   'UserData',BtnState,...
   'Callback',callbackStr);


% Environnement label
CompBottom = CompBottom - CompHeight - CompSpace;
CompPos = [CompLeft CompBottom CompWidth CompHeight];
h = uicontrol( ...
   'Style','text', ...
   'Units','normalized', ...
   'Position',CompPos, ...
   'Horiz','left', ...
   'String','Environnement :', ...
   'Interruptible','off', ...
   'BackgroundColor',CompBackGroundColor , ...
   'ForegroundColor','white');



% Save Btn
CompWidth = 0.5*FrameWidth - FrameBorder;
CompPos = [CompLeft+0.5*FrameWidth-FrameBorder CompBottom CompWidth CompHeight];
CompStr='Save';
callbackStr='reader1_save';
HBtnSave=uicontrol( ...
   'Style','pushbutton', ...
   'Units','normalized', ...
   'Position',CompPos, ...
   'String',CompStr, ...
   'Callback',callbackStr);


reader1_main;