export serverDir=/opt/sas/server
export clientDir=/opt/sas/client
export JAVAHOME=/usr/java/jdk1.6.0_07
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$serverDir
check_logfile=/opt/lofar/var/log/checkOTDBServer.log
check_curdate=`date +%Y-%m-%d\ %H:%M:%S`

start_server()
{
      curdate=`date +%Y%m%dT%H%M%S`
      logfile="/opt/lofar/var/log/OTDBServer."$curdate
      echo "Starting server: $JAVAHOME/bin/java -jar $serverDir/jOTDB2.jar paulus boskabouter LOFAR20 sas001 sas001 $port1 $port2 &" | tee -a $logfile
      $JAVAHOME/bin/java -jar $serverDir/jOTDB2.jar paulus boskabouter LOFAR20 sas001 sas001 $port1 $port2 2>&1 1>$logfile&
      serverpid=$!
}

port1=13599
port2=13600
ps -ef | grep -v grep | grep java | grep $port1 2>&1 1>/dev/null
if [ $? -ne 0 ]; then
   start_server
   echo "[${check_curdate}]: Started server. See logfile $logfile" >> $check_logfile
else
   echo "[${check_curdate}]: Server running" >> $check_logfile
fi
