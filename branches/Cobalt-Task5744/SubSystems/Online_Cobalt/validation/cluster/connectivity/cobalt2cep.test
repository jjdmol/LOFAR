#!/bin/sh
#
# Test connectivity from Cobalt to CEP.
#
# CEP consists of a number of systems that are vital for correct operation
# of the Cobalt software. These are: lcs015, ccu001, kis001, lhn001.
# 
# $Id$

# Handle common signals
trap 'exit 1' 1 2 3 15

host=$(hostname)
TARGETS="lcs015 ccu001 kis001 lhn001 sasdb"

status=0
for target in $TARGETS
do
  printf "%-20s " "$host --> $target"
  timeout 1 ping -c 1 $target > /dev/null 2>&1
  sts=$?
  if [[ $sts -ne 0 ]]
  then
    status=1
    if [[ $sts -eq 124 ]]
    then 
      echo "TIMEOUT"
    else
      echo "FAILED"
    fi
  else
    echo "OK"
  fi
done
exit $status
